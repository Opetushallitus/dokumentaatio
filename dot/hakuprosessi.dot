digraph g {
  rankdir=TB;
  node [shape=oval];

  {
    rank=same;
    Hakemus -> Koe -> Valintalaskenta -> Sijoittelu -> Julkaisu -> Vastaanotto -> Ilmoittautuminen;
  }

  Sijoittelu -> Sijoittelu;
  Valintalaskenta -> ValintalaskennanTila;
  Sijoittelu -> ValinnanTila;
  Vastaanotto -> VastaanotonTila;
  Ilmoittautuminen -> IlmoittautumisenTila;
  subgraph cluster_valinta {
    label="Valinta";
    color=blue;
    Valintalaskenta,Sijoittelu,Julkaisu,Vastaanotto;
  }

  Hakemus [label="Hakemus\n- Hakutoive"];
  IlmoittautumisenTila [label="Ilmoittautumisen\ntila"];
  VastaanotonTila [label="Vastaanoton\ntila"];
  ValinnanTila [label="Valinnan\ntila"];
  ValintalaskennanTila [label="Valintalaskennan\ntila"];

  IlmoittautumisenTila,VastaanotonTila,ValinnanTila,ValintalaskennanTila [shape=box];
}
