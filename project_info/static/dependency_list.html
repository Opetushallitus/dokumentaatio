<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>OPH project_info.json yhteenveto</title>

  <style type="text/css">
    #infos {
      border: 1px solid lightgray;
    }
    #infos tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
  </style>
  <script src="lib/sorttable.js"></script>
  <script src="common_ui.js"></script>
</head>
<body>

[<a href="/">menu</a>] Rajaa n채ytett채v채채 <input onkeyup="filter(this.value);" type="text" id="q">
<span id="filterInfo"></span>

<table id="infos">

</table>

<script type="text/javascript">

  var data;
  var table = document.getElementById('infos');

  handleHash()
  ajaxJson('GET', "/rest/url_properties/uses", initTable)

  function redraw() {
    redrawFilteredInfoTable(data.rows, table, data.headers, function(row, infoRow){
      row.forEach(function(txt){addNode(infoRow, "td", txt)})
    }, function (row, included, excluded) {
      var hide = someMatches(row, excluded) || !(included.length == 0 || someMatches(row, included))
      return !hide
    })
    sorttable.makeSortable(table);
  }

  function initTable(json) {
    console.log(json)
    data = {
      headers: ["from","to","url"],
      rows: flatten(Object.keys(json.service2service).map(function (key) {
        var arr = key.split("\.")
        var from = arr[0], to = arr[1];
        return json.service2service[key].map(function (urlProperty) {
          return [from, to, urlProperty]
        })
      }))
    };
    redraw();
  }
</script>

</body>
</html>
